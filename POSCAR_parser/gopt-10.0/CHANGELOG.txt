10.0: complete rewrite
